<Window x:Class="VetDI.CsvMappingDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="CSV列マッピング"
        Height="400"
        Width="600"
        x:Name="ThisWindow">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <DataGrid x:Name="MappingGrid"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  IsReadOnly="False"
                  Grid.Row="0">
            <DataGrid.Columns>
                <DataGridTextColumn 
                    Header="CSV列"
                    Binding="{Binding CsvColumn}"
                    IsReadOnly="True"
                    Width="200"/>
                <DataGridComboBoxColumn 
                    Header="DBフィールド"
                    SelectedItemBinding="{Binding DbField, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    Width="200">
                    <DataGridComboBoxColumn.ElementStyle>
                        <Style TargetType="ComboBox">
                            <Setter Property="ItemsSource"
                                    Value="{Binding DataContext.DbFields, RelativeSource={RelativeSource AncestorType=Window}}"/>
                        </Style>
                    </DataGridComboBoxColumn.ElementStyle>
                    <DataGridComboBoxColumn.EditingElementStyle>
                        <Style TargetType="ComboBox">
                            <Setter Property="ItemsSource"
                                    Value="{Binding DataContext.DbFields, RelativeSource={RelativeSource AncestorType=Window}}"/>
                        </Style>
                    </DataGridComboBoxColumn.EditingElementStyle>
                </DataGridComboBoxColumn>
            </DataGrid.Columns>
        </DataGrid>
        <StackPanel 
            Grid.Row="1"
            Orientation="Horizontal"
            HorizontalAlignment="Right"
            Margin="0,10,0,0">
            <Button 
                Content="OK"
                Width="80"
                Margin="0,0,10,0"
                Click="Ok_Click"/>
            <Button 
                Content="キャンセル"
                Width="80"
                Click="Cancel_Click"/>
        </StackPanel>
    </Grid>
</Window>
